import { AIGNE, UserInputTopic, UserOutputTopic } from "@aigne/core";
import mapper from "./agents/mapper.js";
import reviewer from "./agents/reviewer.js";
export async function generateMapping({ input, model, }) {
    if (!model)
        throw new Error("model is required to run data mapper");
    const aigne = new AIGNE({ model, agents: [mapper, reviewer] });
    aigne.publish(UserInputTopic, input);
    const { message } = await aigne.subscribe(UserOutputTopic);
    return {
        jsonata: message.jsonata || "",
        confidence: message.confidence || 0,
        confidenceReasoning: message.confidenceReasoning || "",
    };
}
export { applyJsonata } from "./tools.js";
