<!DOCTYPE html>
<html lang="{{ .Site.LanguageCode | default "en" }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ .Site.Title }}</title>
  <link rel="stylesheet" href="/css/style.css">
  {{ if .Site.Params.adsense_enabled }}
  <!-- Google AdSense -->
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client={{ .Site.Params.adsense_publisher_id }}"
     crossorigin="anonymous"></script>
  {{ end }}
  {{ if .Site.Params.ga4.id }}
  <!-- Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ .Site.Params.ga4.id }}"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ .Site.Params.ga4.id }}');
  </script>
  {{ end }}
</head>
<body>

<header class="tb-header">
  <div class="container">
    <h1><a href="/">{{ .Site.Title }}</a></h1>
    <p>{{ .Site.Params.tagline }}</p>
    <nav>
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/posts/">Posts</a></li>
        <li><a href="/test-posts/">Test Posts</a></li>
        <li><a href="/about/">About</a></li>
        <li><a href="/contact/">Contact</a></li>
      </ul>
    </nav>
  </div>
</header>

<main class="container">
  <section class="tb-recent-posts">
    <h2>Recent Posts</h2>
    <div class="posts-grid">
      {{ $mainSections := .Site.Params.mainSections | default (slice "posts") }}
      {{ $pages := where .Site.RegularPages "Type" "in" $mainSections }}
      {{ range first 20 $pages }}
      <article class="post-card">
        <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
        <time datetime="{{ .Date.Format "2006-01-02" }}">{{ .Date.Format "January 2, 2006" }}</time>
        {{ if .Params.category }}
        <span class="category">{{ .Params.category }}</span>
        {{ end }}
        {{ if .Summary }}
        <p>{{ .Summary | truncate 150 }}</p>
        {{ end }}
      </article>
      {{ end }}
    </div>
  </section>

  {{ if .Site.Taxonomies.categories }}
  <section class="tb-categories">
    <h2>Categories</h2>
    <ul class="category-list">
      {{ range $name, $taxonomy := .Site.Taxonomies.categories }}
      <li>
        <a href="{{ "/categories/" | relURL }}{{ $name | urlize }}">
          {{ $name }} ({{ len $taxonomy }})
        </a>
      </li>
      {{ end }}
    </ul>
  </section>
  {{ end }}

  {{ if .Site.Taxonomies.tags }}
  <section class="tb-tags">
    <h2>Popular Tags</h2>
    <div class="tag-cloud">
      {{ range $name, $taxonomy := .Site.Taxonomies.tags }}
        {{ if gt (len $taxonomy) 2 }}
        <a href="{{ "/tags/" | relURL }}{{ $name | urlize }}" class="tag">
          {{ $name }}
        </a>
        {{ end }}
      {{ end }}
    </div>
  </section>
  {{ end }}
</main>

<footer class="tb-footer">
  <div class="container">
    <p>{{ .Site.Params.copyright }}</p>
    {{ if .Site.Params.twitter }}
    <p>Follow us on <a href="https://twitter.com/{{ .Site.Params.twitter }}">Twitter</a></p>
    {{ end }}
  </div>
</footer>

</body>
</html>
